services:
  # ==========================
  # Backend service
  # ==========================
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    container_name: dao-backend
    ports:
      - "4000:4000"   # adjust if your backend port is different
    environment:
      NODE_ENV: production
      DATABASE_URL: ${DATABASE_URL}  # example, adapt to your env
    depends_on:
      - frontend
    restart: unless-stopped

  # ==========================
  # Frontend service
  # ==========================
  frontend:
    build:
      context: .
      dockerfile: frontend/Dockerfile
    container_name: dao-frontend
    ports:
      - "80:80"
    environment:
      NODE_ENV: production
      VITE_API_URL: ${VITE_API_URL}  # example frontend env
    restart: unless-stopped

  # ==========================
  # Optional Hardhat container
  # ==========================
  hardhat:
    build:
      context: .
      dockerfile: Dockerfile       # root bootstrap Dockerfile
    container_name: dao-hardhat
    working_dir: /app
    volumes:
      - .:/app
    environment:
      NODE_ENV: development
    command: ["npx", "hardhat", "node"]
    ports:
      - "8545:8545"   # Hardhat default RPC
    restart: unless-stopped
